<!DOCTYPE >
<html lang="En">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Michael A. Dennis<michaeladennis@yahoo.com>">
    </head>
    <body>
        <h1>Voting is a great thing. Create a Ballot, let the people speak.</h1>        
        <ul>            
            <li><a href="/Search">Search</a></li>
            <li><a href="/Create-Ballot">Create Ballot</a></li>            
        </ul>
        <form action="" onSubmit="ballotLookUp();return false;">
            <label>Ballot Look-up<label>
            <input type="number" min=1 name="ballot_id" />
            <button type="submit">Search</button>
        </form>        
        <form action="" onSubmit="createBallot();return false;">
            <label>Ballot Name<label>
            <input type="text" name="name" />
            <label>Ballot Description<label>
            <input type="text" name="description" />                
            <button type="submit">Create Ballot</button>
        </form>
                <?=debug($this->ballots);?>
        <script>
            
                function ballotLookUp() { 
                    const endPoint = 'Results';        
                    const ballot_id = this.document.querySelector('input[name="ballot_id"]').value;
                    fetch(`/${endPoint}/${ballot_id}?output=json`)
                    .then(function(response) {
                        return response.json();
                    })
                    .then(function(ballot) {
                        console.log(ballot);
                    })
                    .catch( error => {
                        console.log(error);
                        return false;
                    });//Add Error Message to page!          
                    
                        return false;
                }
                function createBallot() { 
                    const endPoint = 'Create-Ballot';        
                    const name = this.document.querySelector('input[name="name"]').value;
                    const description = this.document.querySelector('input[name="description"]').value;
                    fetch(`/${endPoint}`, {
                        method: 'POST',
                        body: JSON.stringify({name, description,output:'json',process:'Create-Ballot'}), 
                        headers: new Headers({'Content-Type': 'application/json'})
                    })                   
                    .then(function(response) {
                        return response.json();
                    })
                    .then(function(ballot) {
                        console.log(ballot);
                    })
                    .catch( error => {
                        console.log(error);
                        return false;
                    });//Add Error Message to page! 
                    return false;
                }
        </script>
    </body>
</html>
